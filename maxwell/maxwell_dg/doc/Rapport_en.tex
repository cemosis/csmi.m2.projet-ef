\documentclass[a4paper,oneside,10pt]{report}




\usepackage[utf8]{inputenc}
\usepackage[francais]{babel}
\usepackage{fancyhdr}
\usepackage[nodisplayskipstretch]{setspace} 
\usepackage[dvips,a4paper]{geometry}
\usepackage{titlesec} 
\usepackage[hang,small,bf]{caption}
\usepackage{footmisc}
\usepackage{color}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{caption}
\usepackage{colortbl,booktabs}
\usepackage[caption=false]{subfig} 
\usepackage{graphicx}
\usepackage{capt-of}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{float}
\usepackage{pgfplots,pgfplotstable}
\usepackage{xspace}
\usepackage{tikz}
\usepackage{gantt}


\definecolor{lbcolor}{rgb}{0.95,0.95,0.95}
\definecolor{cblue}{rgb}{0.,0.0,0.6}
\definecolor{lblue}{rgb}{0.1,0.1,0.4}
\definecolor{ljk}{rgb}{0.50, 0.625, 0.70}
\definecolor{creme}{RGB}{253, 241, 184}

\definecolor{orange}{RGB}{255, 127, 0}
\definecolor{orangef}{RGB}{204, 85, 0}
\definecolor{vert}{RGB}{22, 184, 78}
\definecolor{bordeau}{RGB}{109, 7, 26}
\definecolor{rose}{RGB}{253, 63, 146}
\definecolor{car}{RGB}{150,0, 24}
\definecolor{grey}{RGB}{206,206,206}
\definecolor{violine}{RGB}{161,6,132}
\definecolor{bleuc}{RGB}{119,181,254}
\definecolor{vertanis}{RGB}{159,232, 85}

% \usepackage{fourier}
% \usepackage{fancybox}
% \usepackage{frcursive}
% \usepackage{multirow}
\usepackage{pict2e}
% \usepackage{verbatim}
 % \usepackage{fancyvrb}
\usepackage{listingsutf8}













\usetikzlibrary{arrows,patterns,plotmarks,shapes,snakes,er,3d,automata,backgrounds,topaths,trees,petri,mindmap}
\usepackage[colorlinks=true,linkcolor=black,bookmarkstype=toc,linktocpage=true]{hyperref}
\setstretch{1.2}
\geometry{lmargin=2.5cm,rmargin=2.5cm,vmargin=4cm}
\setlength{\parindent}{0cm}
%\renewcommand{\thechapter}{\Roman{chapter}}
\titleformat{\chapter}[display]
{\bfseries\Large}
{\filleft\MakeUppercase{\chaptertitlename} \Huge\thechapter}
{4ex}
{\titlerule
\vspace{2ex}%
\filright}
[\vspace{2ex}%
\titlerule]
\renewcommand*\thepart{\arabic{part}}%
\titlespacing*{\chapter}{0pt}{-60pt}{40pt}
\pagestyle{plain} 
\fancyhf{} 
\setlength{\footskip}{30pt} 
\setlength{\textheight}{646pt}
\setlength{\hoffset}{0pt}
\cfoot{\thepage} 
\renewcommand{\headrulewidth}{1.2pt}
\lhead{\leftmark}
\setlength{\skip\footins}{1cm}
\setlength{\footnotesep}{0.3cm}
\renewcommand{\footnotelayout}{\scriptsize}
\renewcommand{\chaptermark}[1]{\markboth{\footnotesize{#1}}{}}
\setstretch{1.2}
\pagenumbering{arabic}




\lstset{ 
  backgroundcolor=\color{lbcolor},   
  basicstyle=\footnotesize \tt,        
  breakatwhitespace=false,     
  columns=fullflexibles,
  breaklines=true,                 
  captionpos=b,                    
  commentstyle=\color{black!70},    
  deletekeywords={...},            
  escapeinside={\%*}{*)},          
  extendedchars=true,              
  frame={top,bottom},
  inputencoding=utf8/latin1,                    
  keepspaces=true,                 
  keywordstyle=\bf \color{red!50},       
  language=C++,  
  mathescape=true,               
  morekeywords={*,...},            
  numbers=left,                    
  numbersep=5pt,                   
  numberstyle=\tiny\color{white}, 
  rulecolor=\color{black},          
  showspaces=false,                
  showstringspaces=false,          
  showtabs=false,                  
  stepnumber=2,                    
  stringstyle=\color{black!50},     
  tabsize=1,    
  texcl=true,                   
  title=\lstname
}

\newtheorem{mydef}{Definition}

\newcommand\Image[3][]{%
  \tabular[b]{@{}c@{}}\includegraphics[#1]{#2}\\
    #3
  \endtabular}


\newcommand{\W}{\mathbf{W}}
\newcommand{\w}{\mathbf{w}}


\begin{document}
\def\chaptername{Chapter} 
\input{./title_page_2.tex} 
\pagestyle{plain}
\setstretch{1.2}


\tableofcontents


\newpage
\null
\vfill
Ce document retranscrit le travail effectué dans le cadre du projet éléments finis. Il est découpé en deux parties : la première partie vise à établir un bilan personnel sur les différents thèmes abordés. La seconde partie vise à établir un ensemble de formulations mathématiques qui justifient l'implémentation de la résolution du problème sous-jacent via la librairie \texttt{Feel++}. Les résultats mathématiques énoncés dans ce travail s'appuient directement sur les travaux de M. P. Helluy, M. Thomas Strub ainsi que du travail de thèse de Mlle Anaïs Crestetto. 
\vfill

\chapter{Modèle mathématique}
\section{Présentation du problème}
We consider here, 2D adimensional Maxwell equations without source term such that, $\forall (\mathbf{x},t) \in \Omega \times [0,T]$,


\begin{equation}
\begin{aligned}
\label{eq:1}
\partial_t \mathbf{E} - \nabla \times \mathbf{H} &= 0,\\
\partial_t \mathbf{H} + \nabla \times \mathbf{E} &= 0.
\end{aligned}
\end{equation}

where $\mathbf{E}(\mathbf{x},t)$, refers to the electrical field and $\mathbf{H}(\mathbf{x},t)$ to the magnetic one. Both fields are considered dependent of the space variable  $\mathbf{x}=(x_1,x_2)\in \Omega \subset \mathbb{R}^2$ and of the time $t$.\\


We consider now consider the magnetic transverse mode (TM) (where  $\mathbf{H}$ has a unique component along $z$), in a Cartesian coordinates system, we then 

\begin{eqnarray}
\partial_t E_x - \partial_y H_z  &=& 0, \label{eq:2a}\\
\partial_t E_y + \partial_x H_z &=& 0, \label{eq:2b}\\
\partial_t H_z + \partial_x E_y - \partial_y E_x &=& 0, \label{eq:2c}
\end{eqnarray}

These are linear equations, that we will try to solve numerically. For this, we will use the C++ library \texttt{Feel++}. 


\section{Système de lois de conservation}
In this section we will demonstrate the strict hyperbolicity of the previous system. Let us introduce the general form of a system of conservation law, we note by,

\begin{equation}
\label{eq:sysh}
\partial_t \mathbf{W} +  \partial_i F^i(\mathbf{W}) = S(\mathbf{W}).
\end{equation}

where, $\mathbf{W}(\mathbf{x},t) \in \mathbb{R}^n$, the conservative quantity, is depending of the space $\mathbf{x} = (x_1,x_2,x_3)$, and the time $t$. Terms $F^i$ refer to the physical flux and $S$ the source term

\textbf{Note } : In order to simplify our notation, we'll use the Einstein convention on repeated index :  then substitute by $\partial_i F^i$ the term $\sum_{i=1}^{3}\partial _i F^i$.\newline


Noting first the vector $\mathbf{W}$ and matrices, $\mathbf{A}^1$ and $\mathbf{A}^2$ such as


\begin{equation}
\mathbf{W}=
\begin{pmatrix}
E_x\\
E_y\\
B_z
\end{pmatrix},
\qquad
\mathbf{A}^1=
\begin{pmatrix}
0 & 0 & 0\\
0 & 0 & 1\\
0 & 1 & 0
\end{pmatrix},
\qquad
\mathbf{A}^2=
\begin{pmatrix}
0 & 0 & -1\\
0 & 0 & 0\\
-1 & 0 & 0\\
\end{pmatrix},
\end{equation}
equations (\ref{eq:2a}), (\ref{eq:2b}) and (\ref{eq:2c}) become,

\begin{equation}
\label{eq:sysh2}
\partial_t \mathbf{W} +  \mathbf{A}^i\partial_i \mathbf{W} = 0 \quad \forall (\mathbf{x},t) \in \Omega \times [0,T],
\end{equation}

We'll now prove the hyperbolicity of system (\ref{eq: sysh2}), with the following theorem,

\begin{mydef}
\label{th1}
For all $j=1,\dots,d$ let,

\begin{equation}
\mathbf{A}^j(\mathbf{u}) = \left( \frac{\partial f_{ij}}{\partial u_k} (\mathbf{u}) \right)_{1\leq i,k\leq p}
\end{equation}

be the Jacobian matrix of$\mathbf{f}_j(\mathbf{u})$, the system (\ref{eq:sysh2}) is called hyperbolic, if for all $\mathbf{u}=(u_1,\dots u_p) \in\Omega$ and $\mathbf{n}=(n_1,\dots, n_d) \in \mathbb{R}^d$, $\mathbf{n} \neq 0$ the matrix,

\begin{equation}
\mathbf A^jn_j = \mathbf{A}(\mathbf{u},\mathbf{n}) = \sum\limits_{j=1}^d \mathbf{A}^j(\mathbf{u})n_j 
\end{equation}

has $p$ eigenvalues $\lambda_1(\mathbf{u},\mathbf{n}) \leq \lambda_2(\mathbf{u},\mathbf{n}) \leq \dots \leq  \lambda_p(\mathbf{u},\mathbf{n}) $ and $p$ linearly independent corresponding eigenvectors $\mathbf{r_1}(\mathbf{u},\mathbf{n}), \dots, \mathbf{r_p}(\mathbf{u},\mathbf{n})$, \textit{ie} 
\begin{equation}
\mathbf{A}(\mathbf{u},\mathbf{n})\mathbf{r_k}(\mathbf{u},\mathbf{n}) = \lambda_k(\mathbf{u},\mathbf{n})\mathbf{r_k}(\mathbf{u},\mathbf{n}), \quad 1\leq k \leq p.
\end{equation}
If in adition, the eigenvalues $\lambda_k(\mathbf{u},\mathbf{n})$ are all distinc, the system (\ref{eq:sysh2}) is called strictly hyperbolic.
\end{mydef}




Thus, $\forall (n_1,n_2 )^T \in \mathbb{R}^2$,

\begin{equation}
\mathbf{A}^i n_i = \mathbf{A}^1 n_1 + \mathbf{A}^2 n_2 =
\begin{pmatrix}
0 & 0 & 0\\
0 & 0 & n_1\\
0 & n_1 & 0
\end{pmatrix}
+
\begin{pmatrix}
0 & 0 & -n_2\\
0 & 0 & 0\\
-n_2 & 0 & 0
\end{pmatrix}
=
\begin{pmatrix}
0 & 0 & -n_2\\
0 & 0 & n_1\\
-n_2 & n_1 & 0\\
\end{pmatrix}.
\end{equation}


Hence by solving the following equations

\begin{equation}
\mbox{det} (\mathbf{A}^i n_i - \lambda\mathbb{I}) =
\begin{vmatrix}
-\lambda_1 & 0 & -n_2\\
0 & -\lambda_2 & n_1\\
-n_2 & n_1 & -\lambda_3
\end{vmatrix}
=0,
\end{equation}

we obtain for eigenvalues $\{\lambda_1,\lambda_2,\lambda_2\}$ of the matrix $\mathbf{A}^i n_i$, 
\begin{equation}
\label{eq:vp}
\lambda_1 = -\sqrt{n_1^2 + n_2^2},\quad \lambda_2 =0,\quad \lambda_3 = \sqrt{n_1^2 + n_2^2},
\end{equation}

posing for all $(n_1^2 + n_2^2) \neq 0 $ 
$$r=\sqrt{n_1^2 + n_2^2},$$
we have now, for the corresponding eigenvectors,

\begin{equation}
\mathbf{r}_{1}=
\begin{pmatrix}
-n_2\\
n_1\\
-r
\end{pmatrix},
\qquad
\mathbf{r}_2=
\begin{pmatrix}
n_1\\
n_2\\
0
\end{pmatrix},
\qquad
\mathbf{r}_{3}=
\begin{pmatrix}
-n_2\\
n_1\\
r
\end{pmatrix}.
\end{equation}
\begin{center}
\fbox{Thus, the system is strictly hyperbolic.}\\
\end{center}
\textbf{Remarque} : Furthermore, because the matrix $\mathbf{A}^in_i $ is symmetric, the system is said to Friedrich.\\


\subsection{Boundary Conditions}

%Afin d'assurer l'existence et l'unicité d'une solution au problème (\ref{eq:sysh2}) nous lui ajoutons la condition initiale suivante,

In order to ensure the existence and unicity for a solution of (\ref{eq:sysh2}) we add an initial condition,

\begin{equation}
\label{eq:ini} 
\mathbf{W}(\mathbf{x},0)=\mathbf{W}_0(\mathbf{x}),
\end{equation}

and the boundary condition

\begin{equation}
\label{eq:bound} 
\mathbf{M}(\mathbf{x})(\mathbf{W}-\mathbf{W}_{in})=0\quad\forall \mathbf{x} \in \partial \Omega.
\end{equation}

with, $\mathbf{W}_0$, $\mathbf{W}_{in}$ et $\mathbf{M}$ given.\newline

%L'existence et l'unicité d'une solution à (\ref{eq:sysh2}) sont subordonnées au fait que la matrice $\mathbf{M}$ vérifie (voir thèse de Anaïs Crestetto),
Existence and unicity of a solution of (\ref{eq:sysh2})  are given by the fact that the matrix $\mathbf{M}$ verify
\begin{equation}
\label{eq:ctr1}
\mathbf{N} = \frac{1}{2} \mathbf{A}^in_i + \mathbf{M}\quad \mbox{(existence)},
\end{equation}

with $\mathbf{N}$ a positive matrix such that,

\begin{equation}
\label{eq:ctr2}
\mbox{Ker}\mathbf{M} \subset \mbox{Ker}\mathbf{A}^in_i \quad \mbox{(unicity)}.
\end{equation}

Thus with those conditions, the problem becomes : find  $\mathbf{W}\in\Omega \times [0,T]$ solution of,

\begin{equation}
\label{eq:final}
\mathcal{P} \left\{
\begin{aligned}
\partial_t \mathbf{W} +  \mathbf{A}^i\partial_i \mathbf{W} &= 0 &\quad &\forall (\mathbf{x},t) \in \Omega \times [0,T],\\
\mathbf{W}(\mathbf{x},0)&=\mathbf{W}_0(\mathbf{x}) &\quad &\forall \mathbf{x} \in \Omega,\\
\mathbf{M}(\mathbf{x})(\mathbf{W}-\mathbf{W}_{in})&=0&\quad&\forall \mathbf{x} \in \partial\Omega.
\end{aligned}
\right.
\end{equation}

where, $\mathbf{W}_{in}$ denotes the exact solution.

\section{Discontinuous Garlerkin Method}

\subsection{Weak forumaltion}

We consider now the problem (\ref{eq:final}) and a finite splitting of our domain $\Omega$ such as

\begin{equation}
\bar{\Omega} = \cup_k \bar{L}_k.
\end{equation}

We now consider the restriction on a cell $L_k$ of a regular solution $\mathbf{W}_k$ and we define the following domain 

\begin{equation}
V = \left\{\mathbf{W}(.,t) : \Omega \rightarrow \mathbb{R}^3\ | \ \mathbf{W}_{|L_k}(.,t) \in  (H^1(L_k))^3 \right\}
\end{equation}

Let us now define the regularity domain of the function $\mathbf{W}$ such as,
\begin{equation}
R = \cup_k L_k
\end{equation} 
and in the same way the define domain where the function $\mathbf{W}$ admit all these discontinuity such as

\begin{equation}
\Omega - R = D = \cup_k \partial L_k
\end{equation}


\textbf{Remarque} Because the function $\mathbf{W}$ inst not continue  through a surface of $D$, we have to introduce the values $\mathbf{W}_L$ and $\mathbf{W}_R$ respectively associated to the value of the function  $\mathbf{W}$ on the left and right side of the discontinuity. In the same way, let us define $\mathbf{\phi}_L$ and $\mathbf{\phi}_R$ espectively the values of the test function from either side of the discontinuity. 
\newline

We get the weak formulation, find $\mathbf{W} \in V$ solution of the problem, $\forall \mathbf{\phi} \in V$

\begin{equation}
\int_R \partial_t \mathbf{W} \cdot \mathbf{\phi}+
\int_R  (\mathbf{A}^i \partial i \mathbf{W}) \cdot \mathbf{\phi}+
\int_D \mathbf{F}^*(\mathbf{W}_L,\mathbf{W}_R,\mathbf{\phi}_L,\mathbf{\phi}_R)+
\int_{\partial \Omega} \mathbf{M}(\mathbf{W}_L - \mathbf{W}_{inc})\cdot \mathbf{\phi}_L=0\\
\end{equation}



\textbf{Remark 1} : Dirchlet boundary conditions are weakly imposed using the left value of $\mathbf{W}$ L$ with \mathbf{W}_L \in D \cap \partial \Omega$.\\
\newline
\textbf{Remark 2} :  The function $\mathbf{F}^*$,  is called numerical flux. It will try to approximate  (under some conditions) the physical flux$\mathbf{F}$ (undefined at the interface)using a well chosen combination mixing left and right state. A this time we have not yet given an explicit expression of  $\mathbf{F}^*$.


\subsection{Introduction of the method}
Just like the finite element method (FEM), the discontinuous Galerkin method (DG)  aims to represent the unknown  by polynomial fonctions. However, unlike the FEM, the polynomials are not considered as continuous at the interfaces between meshes forming our computational domain. Thus, by this important particularity, and in view of keeping a good data transfer between meshes, we will need to use the central notion of numerical flux.\newline

The idea of the DG method is to start with a mesh with finite number $N\in \mathbb{N}$ of cells $L_k \subset \Omega$, $k=1\dots N$ (disjoint, open set), such as
\begin{equation}
\bar{\Omega} = \cup_k \bar{L}_k.
\end{equation}

and to approach the unknown $\mathbf{W}$, in each cell, by a linear combination of polynomial functions. Thus, in each cell $L_k$, we consider a basis of polynomial functions of degree $d$ with a $L_k$ support such as
\begin{equation}
\phi^{L_k}_i(\mathbf{x}) \in \mathbb{P}^{d}(L_k)\ i=1,\dots d.
\end{equation}
%Enfin on suppose que notre solution approchée $\mathbf{W}^h$ peut s'écrire localement de la manière suivante,
Finally, we assume that our approximated solution $\mathbf{W}^h$ can be written locally as follows
\begin{equation}
\label{approx}
\mathbf{W}^h_{L_k}(\mathbf{x},t) = \sum\limits_{j=1}^d \mathbf{W}_{L_k}(\mathbf{x}_j,t) \phi_j^L (\mathbf{x}) \quad \forall \mathbf{x} \in L_k
\end{equation}


In the expression (\ref{approx2}), the index $i$ is the node of the mesh $L_k$ where the quantity $\mathbf{W}^h_{L_k}$ is evaluated. In the following we will denote $\mathbf{W}_{L_k}(\mathbf{x}_j,t)$ by $\mathbf{W}_{L_k}^j(t)$.\\
%On constatera également que la solution globale  $\mathbf{W}^h(t)$ est entièrement déterminée par ses composantes (inconnues du problème discret) $\mathbf{W}_{L_k}^j(t)$.\\
We will also notice that the global solution $\mathbf{W}^h(t)$ is entirely determined by its components (unknown of the discrete problem) $\mathbf{W}_{L_k}^j(t)$.\\

In order to determine the unknowns $\mathbf{W}_{L_k}^j(t)$, we multiply the expression  (\ref{}) by a test function $\phi^{L_k}(\mathbf{x})$ and we integrate over $L_k$ (Galerkin method). We then have,  $\forall k$
\begin{equation}
\label{schema}
\frac{d\mathbf{W}_{L_k}^j(t)}{dt}\int_{L_k}\phi^{L_k}_n(\mathbf{x}) \phi^{L_k}_j(\mathbf{x})dx - \int_{L_k}  \mathbf{A}^i \mathbf{W}_{L_k}^j(t)\partial_i \phi^{L_k}_n(\mathbf{x}) \phi^{L_k}_j dx  \int_{\partial L_k} \mathbf{F}^*( \mathbf{W}_L,\mathbf{W}_R,\mathbf{n}) \phi^{L_k}_j= 0.
\end{equation}


Since the function $\mathbf{W}$ is not supposed to be known at the interfaces between cells, it is impossible for us to define the quantity $\mathbf{A}^i \mathbf{W}\phi_j^{L_k}$ on $\partial L_k$. Thus, we have to put a numerical flux $\mathbf{F}^*$ that will try to approach the real physical flux $\mathbf{F}$ at the interfaces. This numerical flux will be computed from the left $\mathbf{W_L}$ and right $\mathbf{W_R}$ state of the shared surface between two neighbour cells.
\newline

%\textbf{Remarque :} C'est ce dernier qui assurera la "propagation d'informations" entre les différentes cellules de notre maillage.
\textbf{Remark:} It's the latter that will insure the "data propagation" between different cells of our mesh.


We notice that the previous formulae relies on the interface between neighbour cells (two states: left/right), and thus, in its  actual form, it doesn't deal with the boundaries of the domain $\partial \Omega$. In order to take into consideration the boundary conditions of the problem we will replace the numerical flux $\mathbf{F}^*( \mathbf{W}_L,\mathbf{W}_R,\mathbf{n})$ with a numerical flux considering only the left state of the mesh such as $\partial L_k \cap \partial \Omega \neq \emptyset$. We denote this flux by 

\begin{equation}
\mathbf{F}^b( \mathbf{W}_L,\mathbf{n}) \quad \forall k\ | \ \partial L_k \cap \partial \Omega \neq \emptyset
\end{equation}



\textbf{Remark:} This numerical flux will take into consideration the boundary conditions that we will impose on our domain. In the actual implementation the boundary conditions are set through ghost state.

% \begin{equation}
% \int_{L_k} \partial_t \mathbf{W} \phi^{L_k}_j - \int_{L_k} \mathbf{A}^i \mathbf{W} \partial_i \phi_j^{L_k} + \int_{\partial L_k} \mathbf{F}^*( \mathbf{W}_L,\mathbf{W}_R,\mathbf{n}) \phi^{L_k}_j= 0.
% \end{equation}


\section{Evolution in time}


We notice that the semi-discrete expression (\ref{schema}) can be rewritten on allover the computational domain as follows
\begin{equation}
\frac{d\mathbf{W}_{h}(t)}{dt} = Q\left(\mathbf{W}_{h}(t),t\right)
\end{equation}

%ce qui correspond à un système d'équations différentielles ordinaires (EDO). Il existe plusieurs méthodes pour résoudre ce type de systèmes, dans \texttt{SCHNAPS} nous utiliserons une méthode de Runge-Kutta d'odre 2. On a alors,
which corresponds to an ordinary differential equations system (EDO). There exists several methods to resolve such a system, in \texttt{SCHNAPS} we will use the Runge-Kutta method of order 2. We then have,

\begin{equation}
\begin{aligned}
\mathbf{K}_1 &= Q\left(\mathbf{W}_{h}^j(t),t\right)\\
\mathbf{K}_2 &= Q\left(\mathbf{W}_{h}^j(t)\ + 0.5\Delta_t\mathbf{K}_1 ,t + 0.5\Delta_t \right)\\
\mathbf{W}_{h}(t+\Delta_t) &= \mathbf{W}_{h}(t+\Delta_t) + \Delta_t\mathbf{K}_2
\end{aligned}
\end{equation}
%avec $\Delta_t$ le pas du temps du système donné par la condition $0 < \mathrm{CFL} \leq 1$ suivante,
with $\Delta_t$ the time step of the system given with the following condition, $0 < \mathrm{CFL} \leq 1$ 
\begin{equation}
\Delta_t \leq \mathrm{CFL} \frac{\max\limits_k(\lambda_k) \min\limits_\Omega (h)}{2d+1}
\end{equation}
%où $d$ désigne l'ordre polynomiale employé, $h$ la taille de la maille, et l$\lambda_k$ les valeurs propres de $\mathbf{A}$
where $d$ refers to the polynomial order used, h the mesh size, and $\lambda_k$the eigenvalues of $\mathbf{A}$.

\subsubsection{\textbf{Feel++} implementation}
%L'intégration en temps via la méthode RK2 est la suivante, ici les paramètre CFL et Tfinal sont passés en option au lancement du programme.
The time integration via the RK2 method is the following, here the parameters CFL and Tfinal are given as options in the command line at the launch of the simulation.
%\textbf{Remarque} : Les champs sont initialisés à $t=0$ avec la projection $L^2$ de la solution exacte sur l'espace d'approximation $X_h$.
\textbf{Remark} : The fields are initialised at $t=0$ with a $L^2$ projection of the exact solution over the approximation space $X_h$.
\begin{center}
\begin{minipage}{\textwidth}
\begin{lstlisting}[label=code2,caption=Integration en temps : run()]
//Definition of the discontinuous projection
auto L2ProjDisc = opProjection( _domainSpace=Xh, _imageSpace=Xh, _type=L2 );
//Projection on Xh of the exact solution 
Exn = L2ProjDisc->project( Ex_ex_expr );
Eyn = L2ProjDisc->project( Ey_ex_expr );
Bzn = L2ProjDisc->project( Bz_ex_expr );

//Time step computing
dt= CFL*meshSize/( 2*Order_poly+1 );
time = 0;
//Mass matrix assembling
this-> assemble_LHS();

//RK2 Method
while (time <= Tfinal){
	RHX assembling
	this->assemble_RHS(time, Exn, Eyn, Bzn);
	//Solving MW=RHS
	this->solve(dtExn,dtEyn,dtBzn);
	//K1
	Exn.add( dt/2.0, dtExn);
	Eyn.add( dt/2.0, dtEyn);
	Bzn.add( dt/2.0, dtBzn);
	time=time + dt/2.0;
	//K2
	this->assemble_RHS(time, Exn, Eyn, Bzn);
	this->solve(dtExn,dtEyn,dtBzn);
	Exn.add( dt, dtExn);
	Eyn.add( dt, dtEyn);
	Bzn.add( dt, dtBzn);
	time = time + dt/2.0;
//Exporting results
}
\end{lstlisting}
\end{minipage}
\end{center}

\section{Numerical Flux}
%Dans cette section on vise à établir une forme explicite du flux numérique $\mathbf{F}^*$.
In this section we intend to establish an explicit form of the numerical flux $\mathbf{F}^*$.
\subsection{Rsolution of the local Riemann problem}
%Le problème auquel nous sommes confrontés actuellement, est de trouver un flux numérique qui tend à approcher le flux physique lorsque la taille de la maille tend vers 0 \textit{ie}
The problem we are facing now is to find a numerical flux which tends to approach the physical flux when the mesh size tends to 0 \textit{ie}
\begin{equation}
\mathbf{F}^*(\mathbf{W},\mathbf{W},\mathbf{n}) = \mathbf{F }(\mathbf{W},\mathbf{n}) \quad (\mbox{Consistence})
\end{equation}
%De la même manière, celui-ci devra vérifier la propriété de conservation telle que, 
It should also verify the conservation property, such as
\begin{equation}
\mathbf{F}^*(\mathbf{W}_L,\mathbf{W}_R,\mathbf{n}_{L/R}) = -\mathbf{F}^*(\mathbf{W}_R,\mathbf{W}_L,\mathbf{n}_{R/L}).
\end{equation}

The construction of a numerical flux is a local procedure which, within the framework of the DG method, can be seen as a Riemann problem at the interface between two neighbour cells. Thus, putting the interface at 0, the local Riemann problem associated to the equation (\ref{}) becomes,
\begin{equation}
\label{Riem}
\left\{
\begin{aligned}
\partial_t \mathbf{W} + \mathbf{A}^i \partial_i \mathbf{W} &= 0,\\
\mathbf{W}(0,\mathbf{x}) &= \left\{
\begin{aligned}
&\mathbf{W}_L& &\mbox{ si } x < 0&\\
&\mathbf{W}_R& &\mbox{ si } x \geq 0&
\end{aligned}
\right.
\end{aligned}
\right.
\end{equation}
%avec $\mathbf{W}_L$ et $\mathbf{W}_L$ deux vecteurs constants connus. Comme le système est strictement hyperbolique (\ref{}) on peu réécrire 
where $\mathbf{W}_L$ and $\mathbf{W}_L$ are two known constant vectors. Since the system (\ref{})  is strictly hyperbolic, we can write:
\begin{equation}
\mathbf{A}^i n_i=\mathbf{P}D\mathbf{P}^{-1},
\end{equation}

where $\mathbf{D}$ is the diagonal matrix containing the eigenvalues of $\mathbf{A}^i n_i$. Thus, by introducing the characteristic variables such as
\begin{equation}
\mathbf{V} = \mathbf{P}^{-1}\mathbf{W}
\end{equation}
%et en multipliant à gauche le système (\ref{k}) par $\mathbf{P}^{-1}$, il vient,
and by multiplying the system (\ref{k}) at the left by $\mathbf{P}^{-1}$, we obtain
\begin{equation}
\mathbf{P}^{-1} \partial_t \mathbf{W} + \mathbf{P}^{-1} \mathbf{A}^i \mathbf{P}^{1}\mathbf{P}^{-1}   \partial_i \mathbf{W} = \partial_t \mathbf{V} + \mathbf{D} \partial_i \mathbf{V}  = 0.
\end{equation}

%On constate à présent que dans le système de variable $\mathbf{V}$ le système (\ref{Riem}) est réduit à un ensemble d'équations de transport linéaires, telles que 
We notice at this level that in the system of variables $\mathbf{V}$, the system \ref{Riem}) is reduced to the set of linear transport equations  such as
\begin{equation}
\label{eq:trans}
\partial_t v_i + \lambda_i \partial_x v_i = 0, \quad 1\leq i \leq n,
\end{equation}
%où les $v_i$ sont les composantes de $\mathbf{V}$ et les vitesses $\lambda_i$ les valeurs propre associées à  $\mathbf{A}^i$. La solution exacte de l'une de ces équations (\ref{eq:trans}) est 
where $v_i$ are the components of $\mathbf{V}$, $\lambda_i$ the eigenvalues associated to $\mathbf{A}^i$. The exact solution of one of these equations (\ref{eq:trans}) is

\begin{equation}
v_i(t,x) = v_i(0, x-\lambda_it)
\end{equation} 
%or d'après les conditions initiales de (\ref{eq:Riem}) on a, 
But following the initial conditions of (\ref{eq:Riem}), we have
\begin{equation}
v_i(t,\mathbf{x}) = \left\{
\begin{aligned}
&v_{i,L}& &\mbox{ si } x < \lambda_it,&\\
&v_{i,R}& &\mbox{ si } x \geq \lambda_it.&
\end{aligned}
\right.
\end{equation}


%Or on cherche à résoudre le problème de Riemann $\forall t > 0$ et  centré en $x=0$, d'où
But we want to resolve the Riemann problem $\forall t > 0$ and centered over $x=0$, so we have

\begin{equation}
v_i(t,\mathbf{x}) = \left\{
\begin{aligned}
&v_{i,L}& &\mbox{ si }  0 <\lambda_i,&\\
&v_{i,R}& &\mbox{ si } 0 \geq \lambda_i .&
\end{aligned}
\right.
\end{equation}
 %Ainsi $\forall t > 0$, il vient sous forme matricielle en notant par $\mathbf{D}^+$ et $\mathbf{D}^+$ les parties positive et négative de $\mathbf{D}$,
Thus, $\forall t > 0$,
\begin{equation}
\mathbf{D} \mathbf{V}(t,0) = \mathbf{D}^+\mathbf{V}(t,0) + \mathbf{D}^-\mathbf{V}(t,0)  =  \mathbf{D}^+\mathbf{V}_L  + \mathbf{D}^-\mathbf{V}_R 
\end{equation}
 
 %Enfin en notant par $\mathbf{A}^in_i^+= \mathbf{P}\mathbf{D}^+\mathbf{P}^{-1}$ et  $\mathbf{A}^in_i^-= \mathbf{P}\mathbf{D}^-\mathbf{P}^{-1}$, on obtient de retour dans le système de variables conservatives $\mathbf{W}$,
Finally, writing $\mathbf{A}^in_i^+= \mathbf{P}\mathbf{D}^+\mathbf{P}^{-1}$ and $\mathbf{A}^in_i^-= \mathbf{P}\mathbf{D}^-\mathbf{P}^{-1}$ and recalling the system of conservative variables, we obtain  $\mathbf{W}$,
 \begin{equation}
 \label{flux1}
\mathbf{A} \mathbf{W}(t,0) = \mathbf{P} \mathbf{D}^+\mathbf{V}(t,0) + \mathbf{P}\mathbf{D}^-\mathbf{V}(t,0)  =  \mathbf{A}\mathbf{D}^+\mathbf{V}_L  + \mathbf{A} \mathbf{D}^-\mathbf{V}_R = \mathbf{A}^in_i^+\mathbf{W}_L + \mathbf{A}^in_i^-\mathbf{W}_R.
\end{equation}
 
%Ainsi, on peut à présent définir un flux numérique (moyennant un calcul explicite $\mathbf{A}^i n_i^+$ et $\mathbf{A}^i n_i^-$ ) entre deux cellules voisines en utilisant la valeur du coté gauche de l'interface $\mathbf{W}_L$ et celle du coté droit $\mathbf{W}_R$. On arrive ainsi à la définition suivante,
 Consequently, we can now define a numerical flux (through the calculation of $\mathbf{A}^i n_i^+$ and $\mathbf{A}^i n_i^-$ ) between two neighbor cells by using the value of the left side of the interface $\mathbf{W}_L$ and the one on the right $\mathbf{W}_R$. We are thus led to the following definition,
 
\begin{mydef}
%Pour un système hyperbolique linéaire, le flux numérique décentré en amont s'écrit 
For a linear hyperbolic system the upwind numerical decentered flux can be written as,
 \begin{equation}
 \mathbf{F}^*(\mathbf{W_L},\mathbf{W_R},\mathbf{n}) = \mathbf{A}^i n_i^+\mathbf{W_L} + \mathbf{A}^i n_i^-\mathbf{W_R}
 \end{equation}
with $\mathbf{A}^i n_i^+$ and $\mathbf{A}^i n_i^-$ the positive et negative parts of $\mathbf{A}^i n_i$.
\end{mydef}


\subsection{Retrieving $\mathbf{A}^i n_i^+$ and $\mathbf{A}^i n_i^-$}

%Pour obtenir les matrices $\mathbf{A}^i n_i^+$ et $\mathbf{A}^i n_i^-$ on utilise tout d'abord le fait que, 
In order to explicit the matrices $\mathbf{A}^i n_i^+$ and $\mathbf{A}^i n_i^-$ we will first use the fact that
\begin{equation}
\mathbf{D} =\mathbf{P}^{-1}\mathbf{A}^in_i\mathbf{P}=
\begin{pmatrix}
-r & 0 &0 \\
0& 0 & 0\\
0 & 0 & r\\
\end{pmatrix},
\end{equation}

with $\mathbf{P}$ the transformation matrix and $\mathbf{P}^{-1}$ its inverse, such as,

\begin{equation}
\mathbf{P}=\frac{1}{r}
\begin{pmatrix}
-n2 & n1 &-n2\\
n1 & n2 & n1\\
-r & 0 & r\\
\end{pmatrix}
\quad \mbox{et} \quad
\mathbf{P}^{-1}=\frac{1}{2r^2}
\begin{pmatrix}
-n_2 & n_1 & -r\\
2n_1 & 2n_2 & 0\\
-n_2 & n_1 & r\\
\end{pmatrix}.
\end{equation}

%Ensuite en notant par $\mathbf{D}^+$ et $\mathbf{D}^+$ les parties positive et négative de $\mathbf{D}$, il vient,
Then, let us denote by $\mathbf{D}^+$ and $\mathbf{D}^+$ the positive and the negative parts of $\mathbf{D}$, we have,
\begin{equation}
\mathbf{A}^in_i^+= \mathbf{P}\mathbf{D}^+\mathbf{P}^{-1} = \frac{1}{2}
\begin{pmatrix}
\frac{n_2^2}{r} & \frac{-n_1n_2}{r}  & -n_2 \\
-\frac{n_1n_2}{r}& \frac{n_1^2}{r} & n_1\\
-n_2& n_1 & r\\
\end{pmatrix}
\end{equation}

and

\begin{equation}
\mathbf{A}^in_i^-= \mathbf{P}\mathbf{D}^-\mathbf{P}^{-1} = \frac{1}{2}
\begin{pmatrix}
\frac{-n_2^2}{r} & \frac{n_1n_2}{r}  & -n_2 \\
-\frac{n_1n_2}{r}&  -\frac{n_1^2}{r} & n_1\\
-n_2& n_1 & -r\\
\end{pmatrix}.
\end{equation}



%\subsection{Choix du flux numérique}
\subsection{Choice of the numerical flux}

%En complément du flux décentré en amont (upwind) vu précédemment, on pourra utiliser plusieurs autres types de flux. 
In addition to the upwind flux previously seen, we can use different types of flux.

%\subsubsection{Flux centré}
\subsubsection{Centered flux}
%Un flux numérique très simple est le flux centré qui consiste à prendre la valeur moyenne (arithmétique) entre les flux physiques émanant de gauche et de droite de l'interface. On obtient alors la définition suivante 
A numerical flux is simply a centered flux which consist of taking the mean value between the physical flux coming from the left and the right of the interface. We thus obtain the following definition:
\begin{mydef}
%Dans notre cas, le flux numérique centré s'écrit 
In our case, the numerical flux is written as follow
\begin{equation}
 \mathbf{F}^*( \mathbf{W}_L,\mathbf{W}_R,\mathbf{n})  = \frac{1}{2}\mathbf{A}^i n_i(\mathbf{W_R} - \mathbf{W_L}),
 \end{equation}
\end{mydef}


%\subsubsection{Flux de Rusanov}
\subsubsection{Rusanov flux}
%Dans le cadre des équations de Maxwell étudiées ici, nous prendrons comme célérité des ondes $\sqrt{\epsilon\mu} = c =1$ (problème adimensionné).  Une alternative à la résolution du problème de Riemann local consiste à partir d'un flux centré et à lui ajouter un terme de viscosité. On définit alors le flux de Rusanov de la manière suivante

In the context of the Maxwell equations studied here, we choose the following wave speed $\sqrt{\epsilon\mu} = c =1$ (dimensionless problem). An alternative 
to the resolution of the local Riemann problem consist of starting with a centered flux and adding a viscosity term to it. We thus define the Rusanov flux as follows
\begin{mydef}
\begin{equation}
 \mathbf{F}^*( \mathbf{W}_L,\mathbf{W}_R,\mathbf{n})  = \frac{1}{2}\mathbf{A}^i n_i(\mathbf{W_R} - \mathbf{W_L}) -\frac{1}{2}\max\limits_k |\lambda_k| (\mathbf{W_R} - \mathbf{W_L})
 \end{equation}
%where $\max\limits_k |\lambda_k|$ représente le module de la plus grande valeur propre de $\mathbf{A}^i n_i$. Dans notre cas nous avons $\max\limits_k |\lambda_k|=\sqrt{n_1^2 + n_2^2} = r$
where $\max\limits_k |\lambda_k|$ is the maximum of the modulus of the eigenvalues of  $\mathbf{A}^i n_i$. In our case, we have $\max\limits_k |\lambda_k|=\sqrt{n_1^2 + n_2^2} = r$

\end{mydef}


%\subsubsection{Combinaison linéaire d'un flux centré et décentré en amont}
\subsubsection{Linear combination of a centered and decentered flux}

%Enfin, il sera aussi possible d'employer une combinaison linéaire d'un flux centré et décentré. Celle-ci permet par exemple, d'obtenir une bonne stabilité tout en diminuant la diffusivité du schéma décentré. Ce schéma a bien entendu un coût calculatoire plus élevé. En notant un paramètre $0 \leq \theta \leq 1$ on a alors comme définition du flux numérique,

At the end it is also possible to use a linear combination of centered and decentered flux. This allows us, for example, to obtain a good stability while reducing the diffusivity if the decentered scheme.This scheme has clearly a higher computational cost. Using the parameter $0 \leq \theta \leq 1$, the definition of the numerical flux leads to
\begin{mydef}
\begin{equation}
 \mathbf{F}^*( \mathbf{W}_L,\mathbf{W}_R,\mathbf{n})  = \frac{\theta}{2}\mathbf{A}^i n_i(\mathbf{W_R} - \mathbf{W_L}) + (1 -\theta)(\mathbf{A}^i n_i^+\mathbf{W_L} + \mathbf{A}^i n_i^-\mathbf{W_R})
 \end{equation}
\end{mydef}





\section{Implementation}

%Dans cette section, nous allons détailler les différentes fonctions mises en place
In this section we will give details on the different established functions.  

\begin{enumerate}
%\item Premier terme intégral de la formulation faible
\item First integral term of the weak formulation
\begin{center}
\begin{minipage}{\textwidth}
\begin{lstlisting}[label=code2,caption=Terme integral 1]
// Definition des formes lineaires composante par composante
auto lf_Ex=form1( _test=Xh, _vector=RHS_Ex,_init=true );
auto lf_Ey=form1( _test=Xh, _vector=RHS_Ey,_init=true );
auto lf_Bz=form1( _test=Xh, _vector=RHS_Bz,_init=true );

//Calcul du premier terme de la Formulation faible
lf_Ex=integrate(_range=elements(mesh),_expr= id(v)*dyv(Bzn));
lf_Ey=integrate(_range=elements(mesh),_expr=-id(v)*dxv(Bzn));
lf_Bz=integrate(_range=elements(mesh),_expr=-id(v)*dxv(Eyn)+id(v)*dyv(Exn));
\end{lstlisting}
\end{minipage}
\end{center}


\item Upwind flux

\begin{center}
\begin{minipage}{\textwidth}
\begin{lstlisting}[label=code2,caption=Upwind flux]
/* Upwind Flux : 	Matrices Aini(+) and Aini(-)  for upwind flux 	*/
auto Anp_1 = vec( 0.5*Ny()*Ny(), -0.5*Nx()*Ny(), -0.5*Ny() );
auto Anp_2 = vec( -0.5*Nx()*Ny(), 0.5*Nx()*Nx(), 0.5*Nx() );
auto Anp_3 = vec( -0.5*Ny(), 0.5*Nx(), cst(0.5) );
auto Anm_1 = vec( -0.5*Ny()*Ny(), 0.5*Nx()*Ny(),-0.5*Ny() );
auto Anm_2 = vec( 0.5*Nx()*Ny(), -0.5*Nx()*Nx(), 0.5*Nx() );
auto Anm_3 = vec( -0.5*Ny(), 0.5*Nx(), cst(-0.5) );
	

lf_Ex +=integrate(_range=internalfaces(mesh),_expr=( trans(Anm_1)*(wL-wR))*leftface(id(v) )
																		   + ( trans(Anp_1)*(wL-wR))*rightface(id(v) ) );

lf_Ey +=integrate(_range=internalfaces(mesh),_expr=( trans(Anm_2)*(wL-wR))*leftface(id(v) )
																		   + ( trans(Anp_2)*(wL-wR))*rightface(id(v) ) );


lf_Bz +=integrate(_range=internalfaces(mesh),_expr=( trans(Anm_3)*(wL-wR))*leftface(id(v) )
																		   + ( trans(Anp_3)*(wL-wR))*rightface(id(v) ) );
\end{lstlisting}
\end{minipage}
\end{center}


\item centered flux

\begin{center}
\begin{minipage}{\textwidth}
\begin{lstlisting}[label=code2,caption=Flux numerique centre]
auto Aini_1 = vec(cst(0.), cst(0.),-Ny() );
auto Aini_2 = vec(cst(0.), cst(0.), Nx() );
auto Aini_3 = vec(-Ny() , Nx() ,cst(0.) );

lf_Ex+=integrate( _range=internalfaces(mesh),_expr=0.5*(trans(Aini_1)*(wL*(leftface(id(v)) - wR*rightface(id(v))))));
lf_Ey+=integrate( _range=internalfaces(mesh),_expr=0.5*(trans(Aini_2)*(wL*(leftface(id(v)) - wR*rightface(id(v))))));
lf_Bz+=integrate( _range=internalfaces(mesh),_expr=0.5*(trans(Aini_3)*(wL*(leftface(id(v)) - wR*rightface(id(v))))));
\end{lstlisting}
\end{minipage}
\end{center}

\item Rusanov flux
\begin{center}
\begin{minipage}{\textwidth}
\begin{lstlisting}[label=code2,caption=Flux numerique de Rusanov]
/*Rusanov fux :  Here Lmax denotes the max velocity of waves, physicaly the speed. Matrices Aini are re-used.
lf_Ex+=integrate( _range=internalfaces(mesh),_expr=0.5*(trans(Aini_1)*(wL*(leftface(id(v)) - wR*rightface(id(v)))))
																- lmax*0.5*(trans(Aini_1)*(wL*(leftface(id(v)) - wR*rightface(id(v))))));
lf_Ey+=integrate( _range=internalfaces(mesh),_expr=0.5*(trans(Aini_2)*(wL*(leftface(id(v)) - wR*rightface(id(v)))))
																- lmax*0.5*(trans(Aini_2)*(wL*(leftface(id(v)) - wR*rightface(id(v))))));
lf_Bz+=integrate( _range=internalfaces(mesh),_expr=0.5*(trans(Aini_3)*(wL*(leftface(id(v)) - wR*rightface(id(v)))))
																- lmax*0.5*(trans(Aini_3)*(wL*(leftface(id(v)) - wR*rightface(id(v))))));
\end{lstlisting}
\end{minipage}
\end{center}

\end{enumerate}

\chapter{Results}
\section{Space convergence}

We will highlight and focus on the spacial order of convergence for the DG method. For that we will use the manufactured solutions technique. Let's consider the following solution $\mathbf{W}^{ex}$

\begin{equation}
\mathbf{W}^{ex}=
\begin{bmatrix}
E_x^{ex}\\
E_y^{ex}\\
H_z^{ex}\\
\end{bmatrix}
=
\begin{bmatrix}
0\\
\cos(\pi(x-t))\\
\cos(\pi(x-t))\\
\end{bmatrix}
\end{equation}

We will first verify that $\mathbf{W}^{ex}$ satisfies (\ref{}).


\begin{equation}
\begin{aligned}
\partial_t Ex^{ex} - \partial_y H_z^{ex} &= 0 + 0\\
\partial_t Ey^{ex} + \partial_x H_z^{ex} &= \pi(x-t)\sin(\pi(x-t)) +\pi(x-t)\sin(\pi(x-t)) = 0\\
\partial_t Hz^{ex} + \partial_x E_y^{ex} - \partial_y E_x^{ex}  &= \pi(x-t)\sin(\pi(x-t)) - \pi(x-t)\sin(\pi(x-t)) + 0 = 0\\
\end{aligned}
\end{equation}
which proves that $\mathbf{W}_{ex}$ is indeed a solution of the system  (\ref{}) $\forall (x,t) \in \mathbb{R} \times \mathbb{R}+$.\\


In order tu study convergence in space of the (DG) method, we will take the domain $\Omega$ do be a unit circle and we will set weakly a Dirichlet condition $\mathbf{W} = \mathbf{W}_{ex}$ on the boundary via the flux $\mathbf{F}^b$ . We then evaluate the error between the numerical solution and the analytical solution in $L_2$ norm on all the domain $\Omega$. The $L_2$ error norm with respect to $h$, the space discretization parameter, are reported in talbles ~\ref{tab:spaceconv1} and \ref{tab:spaceconv2} for different polynomial order $d$ at time $t=0.5s$ with a $CFL=0.1$ and an upwind flux.


 \begin{table}[h]
    \centering
    \pgfplotstableread{order1.dat}\loadedtable
    \pgfplotstabletypeset[columns={h,order1},
    columns/{h}/.style={column name=$\min(h)$,
    column type=c,sci, sci zerofill,precision=3
    },
    columns/{order1}/.style={
    column name=Erreur en norme $\|\cdot\|_{L_2}$,column type=c,
    sci,sci zerofill,
    precision=3},
	 every head row/.style={before row=\toprule,after row=\midrule},
    every last row/.style={after row=\bottomrule}
    ]\loadedtable
     \caption{Error in $L_2$ norm between exact and approximate solution, in function of the mesh size. Here $d=1$ and $t=0.5s$}
    \label{tab:1}
  \end{table}
  \begin{figure}[h]
    \centering
    \begin{tikzpicture}[scale=1]
      \begin{loglogaxis}[x=6cm,
        xlabel=$h$,ylabel=$\|\mathbf{W}^{ex}-\mathbf{W}_{h}\|_{L_2}$,
        legend style={at={(0,1)}, anchor=north west}]
        \addplot table[x=h,y={create col/linear regression={y=order1}}]{order1.dat};
        \xdef\slopea{\pgfplotstableregressiona}
        \addlegendentry{Ordre $d=1$ : $\log{erreur}$, pente = $\pgfmathprintnumber{\slopea}$}
		 \end{loglogaxis}
    \end{tikzpicture}
     \caption{Error in $L_2$ norm between exact and approximate solution, in function of the mesh size. Here $d=1$ and $t=0.5s$. $Bz$ component}
    \label{fig:res}
  \end{figure}

 \begin{table}[h]
    \centering
    \pgfplotstableread{order2.dat}\loadedtable
    \pgfplotstabletypeset[columns={h,order2},
    columns/{h}/.style={column name=$\min(h)$,
    column type=c,sci, sci zerofill,precision=3
    },
    columns/{order2}/.style={
    column name=Erreur en norme $\|\cdot\|_{L_2}$,column type=c,
    sci,sci zerofill,
    precision=3},
	 every head row/.style={before row=\toprule,after row=\midrule},
    every last row/.style={after row=\bottomrule}
    ]\loadedtable
     \caption{Error in $L_2$ norm between exact and approximate solution, in function of the mesh size. Here $d=2$ and $t=0.5s$. $Bz$ component}
    \label{tab:1}
  \end{table}
  \begin{figure}[h]
    \centering
    \begin{tikzpicture}[scale=1]
      \begin{loglogaxis}[x=6cm,
        xlabel=$h$,ylabel=$\|\mathbf{W}^{ex}-\mathbf{W}_{h}\|_{L_2}$,
        legend style={at={(0,1)}, anchor=north west}]
        \addplot table[x=h,y={create col/linear regression={y=order2}}]{order2.dat};
        \xdef\slopea{\pgfplotstableregressiona}
        \addlegendentry{Ordre $d=2$ : $\log{erreur}$, pente = $\pgfmathprintnumber{\slopea}$}
		 \end{loglogaxis}
    \end{tikzpicture}
     \caption{Error in $L_2$ norm between exact and approximate solution, in function of the mesh size. Here $d=2$ and $t=0.5s$. $Bz$ component}
    \label{fig:res}
  \end{figure}


  \begin{table}[h]
    \centering
    \pgfplotstableread{order3.dat}\loadedtable
    \pgfplotstabletypeset[columns={h,order3},
    columns/{h}/.style={column name=$\min(h)$,
    column type=c,sci, sci zerofill,precision=3
    },
    columns/{order3}/.style={
    column name=Erreur en norme $\|\cdot\|_{L_2}$,column type=c,
    sci,sci zerofill,
    precision=3},
	 every head row/.style={before row=\toprule,after row=\midrule},
    every last row/.style={after row=\bottomrule}
    ]\loadedtable
     \caption{Error in $L_2$ norm between exact and approximate solution, in function of the mesh size. Here $d=1$ and $t=0.5s$. $Bz$ component}
    \label{tab:1}
  \end{table}
  \begin{figure}[h]
    \centering
    \begin{tikzpicture}[scale=1]
      \begin{loglogaxis}[x=6cm,
        xlabel=$h$,ylabel=$\|\mathbf{W}^{ex}-\mathbf{W}_{h}\|_{L_2}$,
        legend style={at={(0,1)}, anchor=north west}]
        \addplot table[x=h,y={create col/linear regression={y=order3}}]{order3.dat};
        \xdef\slopea{\pgfplotstableregressiona}
        \addlegendentry{Ordre $d=3$ : $\log{erreur}$, pente = $\pgfmathprintnumber{\slopea}$}
		 \end{loglogaxis}
    \end{tikzpicture}
     \caption{Error in $L_2$ norm between exact and approximate solution, in function of the mesh size. Here $d=1$ and $t=0.5s$. $Bz$ component}
    \label{fig:res}
  \end{figure}
  
This prove the high degree of the method.
  
  
\begin{center}
\Image[width=0.5\linewidth]{./fig/Fig1.png}{$Bz$ component}
\captionof{figure}{Graphic example for $d=2$ $t=1.2$ $h_{min}=0.1$ et CFL=0.1} 
\end{center}

Below, a graphic example of a scattering process. The scattering  is get by using a perfect metallic conductor (PMC) boundary condition on the central circle. Here, we simply return the electrical field using a ghost state : $Ex_L=-Ex$, $Ey_L=-Ey$ et $Bz_L=Bz$.The boundary are then implemented,




\begin{center}
\begin{minipage}{\textwidth}
\begin{lstlisting}[label=code2,caption=Conditions aux bords]
auto wex=vec(Ex_ex_expr,Ey_ex_expr,Bz_ex_expr);
auto wMetal = vec( -leftfacev( idv( Exn ) ),-leftfacev( idv( Eyn ) ),leftfacev( idv( Bzn ) ) );
// auto wSivlerM= vec( leftfacev( idv( Exn ) ),-leftfacev( idv( Eyn ) ),-leftfacev( idv( Bzn ) ) );

lf_Ex += integrate(markedfaces( mesh, "Dirichlet" ),trans(Anm_1)*(wL-wex)*id(v) );
lf_Ey += integrate(markedfaces( mesh, "Dirichlet" ),trans(Anm_2)*(wL-wex)*id(v) );
lf_Bz += integrate(markedfaces( mesh, "Dirichlet" ),trans(Anm_3)*(wL-wex)*id(v) );

lf_Ex += integrate(markedfaces( mesh, "Metal" ),trans(Anm_1)*(wL-wMetal)*id(v) );
lf_Ey += integrate(markedfaces( mesh, "Metal" ),trans(Anm_2)*(wL-wMetal)*id(v) );
lf_Bz += integrate(markedfaces( mesh, "Metal" ),trans(Anm_3)*(wL-wMetal)*id(v) );
\end{lstlisting}
\end{minipage}
\end{center}


\begin{center}
\Image[width=0.7\linewidth]{./fig/Fig2.png}{Composante $Bz$}
\captionof{figure}{Exemple de résultats obtenus avec une condition de conducteur métallique parfait sur le cercle centrale}
\end{center}
Actually, i really don't know if these results are physically true or not. One should makes some benchmark in order to get this answer.
\chapter{3D Extension}
\section{Equations}
We consider here, 3D dimensionless Maxwell equations without source term such that, $\forall (\mathbf{x},t) \in \Omega \times [0,T]$,


\begin{equation}
\begin{aligned}
\label{eq:1}
\partial_t \mathbf{E} + \nabla \times \mathbf{H} &= 0,\\
\partial_t \mathbf{H} - \nabla \times \mathbf{E} &= 0.
\end{aligned}
\end{equation}

 where $\mathbf{E}(\mathbf{x},t)$, refers to the electrical field and $\mathbf{H}(\mathbf{x},t)$ to the magnetic one. Both fields are considered dependent of the space variable  $\mathbf{x}=(x_1,x_2,x_3)\in \Omega \subset \mathbb{R}^3$ and of the time $t$.\\

Wich lead to the system, in Cartesian coordinates,

\begin{eqnarray}
\partial_t E_x - \partial_y H_z + \partial_z H_y    &=& 0, \label{eq:3a}\\
\partial_t E_y - \partial_z H_x + \partial_x H_z    &=& 0, \label{eq:3b}\\
\partial_t E_z - \partial_x H_y + \partial_y H_x    &=& 0, \label{eq:3c}\\
\partial_t H_x + \partial_y E_z - \partial_z E_y    &=& 0, \label{eq:3d}\\
\partial_t H_y + \partial_z E_x - \partial_x E_z    &=& 0, \label{eq:3e}\\
\partial_t H_z + \partial_x E_y - \partial_y E_x    &=& 0, \label{eq:3f}.
\end{eqnarray}


Noting first the vector $\mathbf{W}$ and matrices, $\mathbf{A}^1$ and $\mathbf{A}^2$ such as

\begin{equation}
\mathbf{W}=
\begin{pmatrix}
E_x\\
E_y\\
E_z\\
H_x\\
H_y\\
H_z\\
\end{pmatrix},
\qquad
\mathbf{A}^1=
\begin{pmatrix}
0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 1\\
0 & 0 & 0 & 0 & -1 & 0\\
0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & -1 & 0 & 0 & 0\\
0 & 1 & 0 & 0 & 0 & 0\\
\end{pmatrix},
\qquad
\mathbf{A}^2=
\begin{pmatrix}
0 & 0 & 0 & 0 & 0 & -1\\
0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 1 & 0 & 0\\
0 & 0 & 1 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0\\
-1 & 0 & 0 & 0 & 0 & 0\\
\end{pmatrix},
\end{equation}
\begin{equation}
\mathbf{A}^3=
\begin{pmatrix}
0 & 0 & 0 & 0 & 1 & 0\\
0 & 0 & 0 & -1 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0\\
0 & -1 & 0 & 0 & 0 & 0\\
1 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0\\
\end{pmatrix}
\end{equation}


we can note the conservative form,

\begin{equation}
\label{eq:sysh44}
\partial_t \mathbf{W} +  \mathbf{A}^i\partial_i \mathbf{W} = 0 \quad \forall (\mathbf{x},t) \in \Omega \times [0,T],
\end{equation}

We'll now prove the hyperbolicity of system (\ref{eq: sysh2}) thus, $\forall (n_1,n_2,n_3)^T \in \mathbb{R}^3$,


\begin{equation}
\mathbf{A}^i n_i = \mathbf{A}^1 n_1 + \mathbf{A}^2 n_2  + \mathbf{A}^3 n_3 =
\begin{pmatrix}
0 & 0 & 0 & 0 & n_3 & -n_2\\
0 & 0 & 0 & -n_3 & 0 & n_1\\
0 & 0 & 0 & n_2 & -n_1 & 0\\
0 & -n_3 & n_2 & 0 & 0 & 0\\
n_3 & 0 & -n_1 & 0 & 0 & 0\\
-n_2 & n_1 & 0 & 0 & 0 & 0\\
\end{pmatrix}
\end{equation}


we obtain for eigenvalues s $\{\lambda_1,\lambda_2,\lambda_3\}$ of the matrix $\mathbf{A}^i n_i$, 
\begin{equation}
\label{eq:vp}
\lambda_1^{m=2} = -\sqrt{n_1^2 + n_2^2 + n_3^2},\quad \lambda_2^{m=2} =0,\quad \lambda_3^{m=2}  =  \sqrt{n_1^2 + n_2^2 + n_3^2},
\end{equation}

Where $m$ denotes the associated multiplicity. We remark that, because $m=2$ the system is not strictily hyperbolic. Using the same process as in 2D, we obtain for matrices $\mathbf{A}^in_i^+$ and $\mathbf{A}^in_i^-$,

\begin{equation}
\mathbf{A}^in_i^+=
\begin{pmatrix}
\frac{{n2}^{2}+{n3}^{2}}{2\,r} & -\frac{n1\,n2}{2\,r} & -\frac{n1\,n3}{2\,r} & 0 & \frac{n3}{2} & -\frac{n2}{2}\cr
 -\frac{n1\,n2}{2\,r} & \frac{{n1}^{2}+{n3}^{2}}{2\,r} & -\frac{n2\,n3}{2\,r} & -\frac{n3}{2} & 0 & \frac{n1}{2}\cr
 -\frac{n1\,n3}{2\,r} & -\frac{n2\,n3}{2\,r} & \frac{{n2}^{2}+{n1}^{2}}{2\,r} & \frac{n2}{2} & -\frac{n1}{2} & 0\cr
 0 & -\frac{n3}{2} & \frac{n2}{2} & \frac{{n2}^{2}+{n3}^{2}}{2\,r} & -\frac{n1\,n2}{2\,r} & -\frac{n1\,n3}{2\,r}\cr
 \frac{n3}{2} & 0 & -\frac{n1}{2} & -\frac{n1\,n2}{2\,r} & \frac{{n1}^{2}+{n3}^{2}}{2\,r} & -\frac{n2\,n3}{2\,r}\cr
 -\frac{n2}{2} & \frac{n1}{2} & 0 & -\frac{n1\,n3}{2\,r} & -\frac{n2\,n3}{2\,r} & \frac{{n2}^{2}+{n1}^{2}}{2\,r}
 \end{pmatrix}
  \end{equation}
 and
 \begin{equation}
 \mathbf{A}^in_i^-=
 \begin{pmatrix}
 -\frac{{n2}^{2}+{n3}^{2}}{2\,r} & \frac{n1\,n2}{2\,r} & \frac{n1\,n3}{2\,r} & 0 & \frac{n3}{2} & -\frac{n2}{2}\cr
 \frac{n1\,n2}{2\,r} & -\frac{{n1}^{2}+{n3}^{2}}{2\,r} & \frac{n2\,n3}{2\,r} & -\frac{n3}{2} & 0 & \frac{n1}{2}\cr 
 \frac{n1\,n3}{2\,r} & \frac{n2\,n3}{2\,r} & -\frac{{n2}^{2}+{n1}^{2}}{2\,r} & \frac{n2}{2} & -\frac{n1}{2} & 0\cr
 0 & -\frac{n3}{2} & \frac{n2}{2} & -\frac{{n2}^{2}+{n3}^{2}}{2\,r} & \frac{n1\,n2}{2\,r} & \frac{n1\,n3}{2\,r}\cr
 \frac{n3}{2} & 0 & -\frac{n1}{2} & \frac{n1\,n2}{2\,r} & -\frac{{n1}^{2}+{n3}^{2}}{2\,r} & \frac{n2\,n3}{2\,r}\cr
 -\frac{n2}{2} & \frac{n1}{2} & 0 & \frac{n1\,n3}{2\,r} & \frac{n2\,n3}{2\,r} & -\frac{{n2}^{2}+{n1}^{2}}{2\,r}
 \end{pmatrix}.
 \end{equation}


\textbf{Note} : These matrices were computed with the computed Algebra System Maxima (file \texttt{pef.wxm}).

Thus, with theses computation 3D implementation will be easier.

\bibliographystyle{plain}
\bibliography{Rapport}

\end{document}
